<?php  return array (
  'resourceClass' => 'modDocument',
  'resource' => 
  array (
    'id' => 23,
    'type' => 'document',
    'contentType' => 'text/html',
    'pagetitle' => 'Отзывы',
    'longtitle' => '',
    'description' => 'Отзывы пациентов клиники Беласу.',
    'alias' => 'feedback',
    'link_attributes' => '',
    'published' => 1,
    'pub_date' => 0,
    'unpub_date' => 0,
    'parent' => 0,
    'isfolder' => 0,
    'introtext' => '',
    'content' => '',
    'richtext' => 1,
    'template' => 10,
    'menuindex' => 6,
    'searchable' => 1,
    'cacheable' => 1,
    'createdby' => 1,
    'createdon' => 1345889311,
    'editedby' => 1,
    'editedon' => 1345889602,
    'deleted' => 0,
    'deletedon' => 0,
    'deletedby' => 0,
    'publishedon' => 1345889280,
    'publishedby' => 1,
    'menutitle' => '',
    'donthit' => 0,
    'privateweb' => 0,
    'privatemgr' => 0,
    'content_dispo' => 0,
    'hidemenu' => 0,
    'class_key' => 'modDocument',
    'context_key' => 'web',
    'content_type' => 1,
    'uri' => 'feedback',
    'uri_override' => 0,
    'hide_children_in_tree' => 0,
    'show_in_tree' => 1,
    'properties' => NULL,
    '_content' => '<!DOCTYPE html>
<html dir="ltr" lang="ru-RU">
<head>

<meta charset="utf-8">
<title>Отзывы</title>
<meta name="keywords" content="казахстан, шымкент, клиника, лечение">
<meta name="description" content="Отзывы пациентов клиники Беласу.">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<base href="http://belasu.com/"/>

<link rel="stylesheet" media="all" href="http://belasu.com/assets/css/stylesheet.css">
<!--[if IE 6 ]><link rel="stylesheet" media="all" href="http://belasu.com/assets/css/ie6.css"><![endif]-->
<!--[if lt IE 8 ]><link rel="stylesheet" media="all" href="http://belasu.com/assets/css/ie7.css"><![endif]-->

<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="http://belasu.com/assets/js/selectivizr.min.js"></script>
<![endif]-->

</head>

<body class="page">

<header>
 <div class="header-container clearfix">
  <div class="column span_3">
   <div id="logo"><a href="/" title=""><img src="assets/img/logo.png" alt="" title=""></a></div>
   <div id="icons">
    <a href="/" class="icon home" title="На главную"></a>
    <a href="http://belasu.com/sitemap" class="icon sitemap" title="Карта сайта"></a>
    <a href="mailto:info@belasu.kz" class="icon mail" title="Написать нам письмо"></a>
   </div>
  </div>
  <div class="column span_6 nav">
   [[!Wayfinder?
  &startId=`0`
  &outerTpl=`menu-outer`
  &rowTpl=`menu-row`
  &innerTpl=`menu-inner`
  &innerRowTpl=`menu-inner-row`
  &hereClass=`active`
  &firstClass=``
  &lastClass =`` ]]
    [[!Wayfinder?
 				 &startId=`0`
  				&outerTpl=`menu-select-outer`
 				 &rowTpl=`menu-select-row`
  				&innerTpl=`menu-select-inner`
  				&innerRowTpl=`menu-select-inner-row`
  				&hereClass=``
 				 &firstClass=``
  				&lastClass =`` ]]
  </div>
  <div class="column span_3 right">
   <div id="contact">
    <sup >+7(7252)</sup>
    <strong>54-08-28</strong>
    <div class="callout reg"></div>
    <br>
    <strong class="second">53-44-13</strong>
    <div class="callout office"></div>
    <em><a href="/contacts" title="Вся контактная информация">Все контакты</a></em>
   </div>
  </div>
 </div>
</header>

<section id="content">
 <div class="clearfix">
  <h1 class="title border"><b>Отзывы</b></h1>
  <div class="column span_8">
   [[!Quip? &thread=`Feedback` &threading=`0` &tplComments=`comments` &tplComment=`comment` &closeAfter=`0`]]
  </div>
  <div class="column span_4">
   [[!QuipReply? &thread=`Feedback` &tplAddComment=`addcomment` &moderate=`true` &moderatorGroup=`Editor`]]
  </div>
 </div>
</section>

<footer>
 <div id="bottom" class="clearfix">
  <div class="column span_12 copyright smaller">
   <div class="column span_5">
    <p>© 2007-[[!time:date=`%Y`]] Клиника "Беласу".</p>
    <ul>
     <li><a href="http://belasu.com/">Главная</a></li>
     <li><a href="mailto:info@belasu.kz">Написать нам письмо</a></li>
     <li><a href="http://belasu.com/sitemap">Карта сайта</a></li>
    </ul>	
   </div>
   <div class="column span_4">
    <p>г. Шымкент, 160011, улица Казыбек-би, дом 37.<br>
    <a href="mailto:info@belasu.kz">info@belasu.kz</a></p>
   </div>
   <div class="column span_3 right">
    <p>Разработка сайта - <a href="mailto:ayan@exultic.com">Аян Енбекбай</a></p>
   </div>
  </div>
 </div>
</footer>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript" src="http://belasu.com/assets/js/jquery.superfish.js"></script>
<script type="text/javascript" src="http://belasu.com/assets/js/jquery.gradienttext.js"></script>
<script type="text/javascript" src="http://belasu.com/assets/js/jquery.custom.js"></script>

</body>
</html>',
    '_isForward' => false,
  ),
  'contentType' => 
  array (
    'id' => 1,
    'name' => 'HTML',
    'description' => 'HTML content',
    'mime_type' => 'text/html',
    'file_extensions' => '',
    'headers' => NULL,
    'binary' => 0,
  ),
  'policyCache' => 
  array (
  ),
  'elementCache' => 
  array (
    '[[*pagetitle]]' => 'Отзывы',
    '[[*description]]' => 'Отзывы пациентов клиники Беласу.',
    '[[$belasu-head]]' => '<meta charset="utf-8">
<title>Отзывы</title>
<meta name="keywords" content="казахстан, шымкент, клиника, лечение">
<meta name="description" content="Отзывы пациентов клиники Беласу.">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<base href="http://belasu.com/"/>

<link rel="stylesheet" media="all" href="http://belasu.com/assets/css/stylesheet.css">
<!--[if IE 6 ]><link rel="stylesheet" media="all" href="http://belasu.com/assets/css/ie6.css"><![endif]-->
<!--[if lt IE 8 ]><link rel="stylesheet" media="all" href="http://belasu.com/assets/css/ie7.css"><![endif]-->

<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="http://belasu.com/assets/js/selectivizr.min.js"></script>
<![endif]-->',
    '[[$belasu-nav]]' => '[[!Wayfinder?
  &startId=`0`
  &outerTpl=`menu-outer`
  &rowTpl=`menu-row`
  &innerTpl=`menu-inner`
  &innerRowTpl=`menu-inner-row`
  &hereClass=`active`
  &firstClass=``
  &lastClass =`` ]]
    [[!Wayfinder?
 				 &startId=`0`
  				&outerTpl=`menu-select-outer`
 				 &rowTpl=`menu-select-row`
  				&innerTpl=`menu-select-inner`
  				&innerRowTpl=`menu-select-inner-row`
  				&hereClass=``
 				 &firstClass=``
  				&lastClass =`` ]]',
    '[[$belasu-contact]]' => '<div id="contact">
    <sup >+7(7252)</sup>
    <strong>54-08-28</strong>
    <div class="callout reg"></div>
    <br>
    <strong class="second">53-44-13</strong>
    <div class="callout office"></div>
    <em><a href="/contacts" title="Вся контактная информация">Все контакты</a></em>
   </div>',
    '[[$belasu-header]]' => '<header>
 <div class="header-container clearfix">
  <div class="column span_3">
   <div id="logo"><a href="/" title=""><img src="assets/img/logo.png" alt="" title=""></a></div>
   <div id="icons">
    <a href="/" class="icon home" title="На главную"></a>
    <a href="http://belasu.com/sitemap" class="icon sitemap" title="Карта сайта"></a>
    <a href="mailto:info@belasu.kz" class="icon mail" title="Написать нам письмо"></a>
   </div>
  </div>
  <div class="column span_6 nav">
   [[!Wayfinder?
  &startId=`0`
  &outerTpl=`menu-outer`
  &rowTpl=`menu-row`
  &innerTpl=`menu-inner`
  &innerRowTpl=`menu-inner-row`
  &hereClass=`active`
  &firstClass=``
  &lastClass =`` ]]
    [[!Wayfinder?
 				 &startId=`0`
  				&outerTpl=`menu-select-outer`
 				 &rowTpl=`menu-select-row`
  				&innerTpl=`menu-select-inner`
  				&innerRowTpl=`menu-select-inner-row`
  				&hereClass=``
 				 &firstClass=``
  				&lastClass =`` ]]
  </div>
  <div class="column span_3 right">
   <div id="contact">
    <sup >+7(7252)</sup>
    <strong>54-08-28</strong>
    <div class="callout reg"></div>
    <br>
    <strong class="second">53-44-13</strong>
    <div class="callout office"></div>
    <em><a href="/contacts" title="Вся контактная информация">Все контакты</a></em>
   </div>
  </div>
 </div>
</header>',
    '[[$belasu-footer]]' => '<footer>
 <div id="bottom" class="clearfix">
  <div class="column span_12 copyright smaller">
   <div class="column span_5">
    <p>© 2007-[[!time:date=`%Y`]] Клиника "Беласу".</p>
    <ul>
     <li><a href="http://belasu.com/">Главная</a></li>
     <li><a href="mailto:info@belasu.kz">Написать нам письмо</a></li>
     <li><a href="http://belasu.com/sitemap">Карта сайта</a></li>
    </ul>	
   </div>
   <div class="column span_4">
    <p>г. Шымкент, 160011, улица Казыбек-би, дом 37.<br>
    <a href="mailto:info@belasu.kz">info@belasu.kz</a></p>
   </div>
   <div class="column span_3 right">
    <p>Разработка сайта - <a href="mailto:ayan@exultic.com">Аян Енбекбай</a></p>
   </div>
  </div>
 </div>
</footer>',
    '[[%quip.name? &namespace=`quip` &topic=`default`]]' => 'Имя',
    '[[%quip.email]]' => 'Электронная почта',
    '[[%quip.post]]' => 'Отправить отзыв',
  ),
  'sourceCache' => 
  array (
    'modChunk' => 
    array (
      'belasu-head' => 
      array (
        'fields' => 
        array (
          'id' => 3,
          'source' => 1,
          'property_preprocess' => false,
          'name' => 'belasu-head',
          'description' => 'Head для шаблона сайта клиники Беласу.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '<meta charset="utf-8">
<title>[[*pagetitle]]</title>
<meta name="keywords" content="казахстан, шымкент, клиника, лечение">
<meta name="description" content="[[*description]]">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<base href="[[++site_url]]"/>

<link rel="stylesheet" media="all" href="[[++site_url]]assets/css/stylesheet.css">
<!--[if IE 6 ]><link rel="stylesheet" media="all" href="[[++site_url]]assets/css/ie6.css"><![endif]-->
<!--[if lt IE 8 ]><link rel="stylesheet" media="all" href="[[++site_url]]assets/css/ie7.css"><![endif]-->

<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="[[++site_url]]assets/js/selectivizr.min.js"></script>
<![endif]-->',
          'locked' => false,
          'properties' => 
          array (
          ),
          'static' => false,
          'static_file' => '',
          'content' => '<meta charset="utf-8">
<title>[[*pagetitle]]</title>
<meta name="keywords" content="казахстан, шымкент, клиника, лечение">
<meta name="description" content="[[*description]]">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<base href="[[++site_url]]"/>

<link rel="stylesheet" media="all" href="[[++site_url]]assets/css/stylesheet.css">
<!--[if IE 6 ]><link rel="stylesheet" media="all" href="[[++site_url]]assets/css/ie6.css"><![endif]-->
<!--[if lt IE 8 ]><link rel="stylesheet" media="all" href="[[++site_url]]assets/css/ie7.css"><![endif]-->

<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="[[++site_url]]assets/js/selectivizr.min.js"></script>
<![endif]-->',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
          'id' => 1,
          'name' => 'Filesystem',
          'description' => '',
          'class_key' => 'sources.modFileMediaSource',
          'properties' => 
          array (
          ),
          'is_stream' => true,
        ),
      ),
      'belasu-header' => 
      array (
        'fields' => 
        array (
          'id' => 22,
          'source' => 1,
          'property_preprocess' => false,
          'name' => 'belasu-header',
          'description' => 'Шапка для шаблона сайта клиники Беласу.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '<header>
 <div class="header-container clearfix">
  <div class="column span_3">
   <div id="logo"><a href="/" title=""><img src="assets/img/logo.png" alt="" title=""></a></div>
   <div id="icons">
    <a href="/" class="icon home" title="На главную"></a>
    <a href="[[++site_url]]sitemap" class="icon sitemap" title="Карта сайта"></a>
    <a href="mailto:info@belasu.kz" class="icon mail" title="Написать нам письмо"></a>
   </div>
  </div>
  <div class="column span_6 nav">
   [[$belasu-nav]]
  </div>
  <div class="column span_3 right">
   [[$belasu-contact]]
  </div>
 </div>
</header>',
          'locked' => false,
          'properties' => 
          array (
          ),
          'static' => false,
          'static_file' => '',
          'content' => '<header>
 <div class="header-container clearfix">
  <div class="column span_3">
   <div id="logo"><a href="/" title=""><img src="assets/img/logo.png" alt="" title=""></a></div>
   <div id="icons">
    <a href="/" class="icon home" title="На главную"></a>
    <a href="[[++site_url]]sitemap" class="icon sitemap" title="Карта сайта"></a>
    <a href="mailto:info@belasu.kz" class="icon mail" title="Написать нам письмо"></a>
   </div>
  </div>
  <div class="column span_6 nav">
   [[$belasu-nav]]
  </div>
  <div class="column span_3 right">
   [[$belasu-contact]]
  </div>
 </div>
</header>',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
          'id' => 1,
          'name' => 'Filesystem',
          'description' => '',
          'class_key' => 'sources.modFileMediaSource',
          'properties' => 
          array (
          ),
          'is_stream' => true,
        ),
      ),
      'belasu-nav' => 
      array (
        'fields' => 
        array (
          'id' => 5,
          'source' => 1,
          'property_preprocess' => false,
          'name' => 'belasu-nav',
          'description' => 'Навигация для шаблона сайта клиники Беласу.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '[[!Wayfinder?
  &startId=`0`
  &outerTpl=`menu-outer`
  &rowTpl=`menu-row`
  &innerTpl=`menu-inner`
  &innerRowTpl=`menu-inner-row`
  &hereClass=`active`
  &firstClass=``
  &lastClass =`` ]]
    [[!Wayfinder?
 				 &startId=`0`
  				&outerTpl=`menu-select-outer`
 				 &rowTpl=`menu-select-row`
  				&innerTpl=`menu-select-inner`
  				&innerRowTpl=`menu-select-inner-row`
  				&hereClass=``
 				 &firstClass=``
  				&lastClass =`` ]]',
          'locked' => false,
          'properties' => 
          array (
          ),
          'static' => false,
          'static_file' => '',
          'content' => '[[!Wayfinder?
  &startId=`0`
  &outerTpl=`menu-outer`
  &rowTpl=`menu-row`
  &innerTpl=`menu-inner`
  &innerRowTpl=`menu-inner-row`
  &hereClass=`active`
  &firstClass=``
  &lastClass =`` ]]
    [[!Wayfinder?
 				 &startId=`0`
  				&outerTpl=`menu-select-outer`
 				 &rowTpl=`menu-select-row`
  				&innerTpl=`menu-select-inner`
  				&innerRowTpl=`menu-select-inner-row`
  				&hereClass=``
 				 &firstClass=``
  				&lastClass =`` ]]',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
          'id' => 1,
          'name' => 'Filesystem',
          'description' => '',
          'class_key' => 'sources.modFileMediaSource',
          'properties' => 
          array (
          ),
          'is_stream' => true,
        ),
      ),
      'belasu-contact' => 
      array (
        'fields' => 
        array (
          'id' => 6,
          'source' => 1,
          'property_preprocess' => false,
          'name' => 'belasu-contact',
          'description' => 'Контактная информация для шаблона сайта клиники Беласу.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '<div id="contact">
    <sup >+7(7252)</sup>
    <strong>54-08-28</strong>
    <div class="callout reg"></div>
    <br>
    <strong class="second">53-44-13</strong>
    <div class="callout office"></div>
    <em><a href="/contacts" title="Вся контактная информация">Все контакты</a></em>
   </div>',
          'locked' => false,
          'properties' => 
          array (
          ),
          'static' => false,
          'static_file' => '',
          'content' => '<div id="contact">
    <sup >+7(7252)</sup>
    <strong>54-08-28</strong>
    <div class="callout reg"></div>
    <br>
    <strong class="second">53-44-13</strong>
    <div class="callout office"></div>
    <em><a href="/contacts" title="Вся контактная информация">Все контакты</a></em>
   </div>',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
          'id' => 1,
          'name' => 'Filesystem',
          'description' => '',
          'class_key' => 'sources.modFileMediaSource',
          'properties' => 
          array (
          ),
          'is_stream' => true,
        ),
      ),
      'belasu-footer' => 
      array (
        'fields' => 
        array (
          'id' => 4,
          'source' => 1,
          'property_preprocess' => false,
          'name' => 'belasu-footer',
          'description' => 'Подвал для шаблона сайта клиники Беласу.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '<footer>
 <div id="bottom" class="clearfix">
  <div class="column span_12 copyright smaller">
   <div class="column span_5">
    <p>© 2007-[[!time:date=`%Y`]] Клиника "Беласу".</p>
    <ul>
     <li><a href="[[++site_url]]">Главная</a></li>
     <li><a href="mailto:info@belasu.kz">Написать нам письмо</a></li>
     <li><a href="[[++site_url]]sitemap">Карта сайта</a></li>
    </ul>	
   </div>
   <div class="column span_4">
    <p>г. Шымкент, 160011, улица Казыбек-би, дом 37.<br>
    <a href="mailto:info@belasu.kz">info@belasu.kz</a></p>
   </div>
   <div class="column span_3 right">
    <p>Разработка сайта - <a href="mailto:ayan@exultic.com">Аян Енбекбай</a></p>
   </div>
  </div>
 </div>
</footer>',
          'locked' => false,
          'properties' => 
          array (
          ),
          'static' => false,
          'static_file' => '',
          'content' => '<footer>
 <div id="bottom" class="clearfix">
  <div class="column span_12 copyright smaller">
   <div class="column span_5">
    <p>© 2007-[[!time:date=`%Y`]] Клиника "Беласу".</p>
    <ul>
     <li><a href="[[++site_url]]">Главная</a></li>
     <li><a href="mailto:info@belasu.kz">Написать нам письмо</a></li>
     <li><a href="[[++site_url]]sitemap">Карта сайта</a></li>
    </ul>	
   </div>
   <div class="column span_4">
    <p>г. Шымкент, 160011, улица Казыбек-би, дом 37.<br>
    <a href="mailto:info@belasu.kz">info@belasu.kz</a></p>
   </div>
   <div class="column span_3 right">
    <p>Разработка сайта - <a href="mailto:ayan@exultic.com">Аян Енбекбай</a></p>
   </div>
  </div>
 </div>
</footer>',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
          'id' => 1,
          'name' => 'Filesystem',
          'description' => '',
          'class_key' => 'sources.modFileMediaSource',
          'properties' => 
          array (
          ),
          'is_stream' => true,
        ),
      ),
    ),
    'modSnippet' => 
    array (
      'Wayfinder' => 
      array (
        'fields' => 
        array (
          'id' => 1,
          'source' => 0,
          'property_preprocess' => false,
          'name' => 'Wayfinder',
          'description' => 'Wayfinder for MODx Revolution 2.0.0-beta-5 and later.',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => '/**
 * Wayfinder Snippet to build site navigation menus
 *
 * Totally refactored from original DropMenu nav builder to make it easier to
 * create custom navigation by using chunks as output templates. By using
 * templates, many of the paramaters are no longer needed for flexible output
 * including tables, unordered- or ordered-lists (ULs or OLs), definition lists
 * (DLs) or in any other format you desire.
 *
 * @version 2.1.1-beta5
 * @author Garry Nutting (collabpad.com)
 * @author Kyle Jaebker (muddydogpaws.com)
 * @author Ryan Thrash (modx.com)
 * @author Shaun McCormick (modx.com)
 * @author Jason Coward (modx.com)
 *
 * @example [[Wayfinder? &startId=`0`]]
 *
 * @var modX $modx
 * @var array $scriptProperties
 * 
 * @package wayfinder
 */
$wayfinder_base = $modx->getOption(\'wayfinder.core_path\',$scriptProperties,$modx->getOption(\'core_path\').\'components/wayfinder/\');

/* include a custom config file if specified */
if (isset($scriptProperties[\'config\'])) {
    $scriptProperties[\'config\'] = str_replace(\'../\',\'\',$scriptProperties[\'config\']);
    $scriptProperties[\'config\'] = $wayfinder_base.\'configs/\'.$scriptProperties[\'config\'].\'.config.php\';
} else {
    $scriptProperties[\'config\'] = $wayfinder_base.\'configs/default.config.php\';
}
if (file_exists($scriptProperties[\'config\'])) {
    include $scriptProperties[\'config\'];
}

/* include wayfinder class */
include_once $wayfinder_base.\'wayfinder.class.php\';
if (!$modx->loadClass(\'Wayfinder\',$wayfinder_base,true,true)) {
    return \'error: Wayfinder class not found\';
}
$wf = new Wayfinder($modx,$scriptProperties);

/* get user class definitions
 * TODO: eventually move these into config parameters */
$wf->_css = array(
    \'first\' => isset($firstClass) ? $firstClass : \'\',
    \'last\' => isset($lastClass) ? $lastClass : \'last\',
    \'here\' => isset($hereClass) ? $hereClass : \'active\',
    \'parent\' => isset($parentClass) ? $parentClass : \'\',
    \'row\' => isset($rowClass) ? $rowClass : \'\',
    \'outer\' => isset($outerClass) ? $outerClass : \'\',
    \'inner\' => isset($innerClass) ? $innerClass : \'\',
    \'level\' => isset($levelClass) ? $levelClass: \'\',
    \'self\' => isset($selfClass) ? $selfClass : \'\',
    \'weblink\' => isset($webLinkClass) ? $webLinkClass : \'\'
);

/* get user templates
 * TODO: eventually move these into config parameters */
$wf->_templates = array(
    \'outerTpl\' => isset($outerTpl) ? $outerTpl : \'\',
    \'rowTpl\' => isset($rowTpl) ? $rowTpl : \'\',
    \'parentRowTpl\' => isset($parentRowTpl) ? $parentRowTpl : \'\',
    \'parentRowHereTpl\' => isset($parentRowHereTpl) ? $parentRowHereTpl : \'\',
    \'hereTpl\' => isset($hereTpl) ? $hereTpl : \'\',
    \'innerTpl\' => isset($innerTpl) ? $innerTpl : \'\',
    \'innerRowTpl\' => isset($innerRowTpl) ? $innerRowTpl : \'\',
    \'innerHereTpl\' => isset($innerHereTpl) ? $innerHereTpl : \'\',
    \'activeParentRowTpl\' => isset($activeParentRowTpl) ? $activeParentRowTpl : \'\',
    \'categoryFoldersTpl\' => isset($categoryFoldersTpl) ? $categoryFoldersTpl : \'\',
    \'startItemTpl\' => isset($startItemTpl) ? $startItemTpl : \'\'
);

/* process Wayfinder */
$output = $wf->run();
if ($wf->_config[\'debug\']) {
    $output .= $wf->renderDebugOutput();
}

/* output results */
if ($wf->_config[\'ph\']) {
    $modx->setPlaceholder($wf->_config[\'ph\'],$output);
} else {
    return $output;
}',
          'locked' => false,
          'properties' => 
          array (
            'level' => 
            array (
              'name' => 'level',
              'desc' => 'prop_wayfinder.level_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '0',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Depth (number of levels) to build the menu from. 0 goes through all levels.',
              'area' => '',
              'area_trans' => '',
            ),
            'includeDocs' => 
            array (
              'name' => 'includeDocs',
              'desc' => 'prop_wayfinder.includeDocs_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '0',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Acts as a filter and will limit the output to only the documents specified in this parameter. The startId is still required.',
              'area' => '',
              'area_trans' => '',
            ),
            'excludeDocs' => 
            array (
              'name' => 'excludeDocs',
              'desc' => 'prop_wayfinder.excludeDocs_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '0',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Acts as a filter and will remove the documents specified in this parameter from the output. The startId is still required.',
              'area' => '',
              'area_trans' => '',
            ),
            'contexts' => 
            array (
              'name' => 'contexts',
              'desc' => 'prop_wayfinder.contexts_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Specify the contexts for the Resources that will be loaded in this menu. Useful when used with startId at 0 to show all first-level items. Note: This will increase load times a bit, but if you set cacheResults to 1, that will offset the load time.',
              'area' => '',
              'area_trans' => '',
            ),
            'cacheResults' => 
            array (
              'name' => 'cacheResults',
              'desc' => 'prop_wayfinder.cacheResults_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Cache the generated menu to the MODX Resource cache. Setting this to 1 will speed up the loading of your menus.',
              'area' => '',
              'area_trans' => '',
            ),
            'cacheTime' => 
            array (
              'name' => 'cacheTime',
              'desc' => 'prop_wayfinder.cacheTime_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 3600,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'The number of seconds to store the cached menu, if cacheResults is 1. Set to 0 to store indefinitely until cache is manually cleared.',
              'area' => '',
              'area_trans' => '',
            ),
            'ph' => 
            array (
              'name' => 'ph',
              'desc' => 'prop_wayfinder.ph_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'To display send the output of Wayfinder to a placeholder set the ph parameter equal to the name of the desired placeholder. All output including the debugging (if on) will be sent to the placeholder specified.',
              'area' => '',
              'area_trans' => '',
            ),
            'debug' => 
            array (
              'name' => 'debug',
              'desc' => 'prop_wayfinder.debug_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'With the debug parameter set to 1, Wayfinder will output information on how each Resource was processed.',
              'area' => '',
              'area_trans' => '',
            ),
            'ignoreHidden' => 
            array (
              'name' => 'ignoreHidden',
              'desc' => 'prop_wayfinder.ignoreHidden_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'The ignoreHidden parameter allows Wayfinder to ignore the display in menu flag that can be set for each document. With this parameter set to 1, all Resources will be displayed regardless of the Display in Menu flag.',
              'area' => '',
              'area_trans' => '',
            ),
            'hideSubMenus' => 
            array (
              'name' => 'hideSubMenus',
              'desc' => 'prop_wayfinder.hideSubMenus_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'The hideSubMenus parameter will remove all non-active submenus from the Wayfinder output if set to 1. This parameter only works if multiple levels are being displayed.',
              'area' => '',
              'area_trans' => '',
            ),
            'useWeblinkUrl' => 
            array (
              'name' => 'useWeblinkUrl',
              'desc' => 'prop_wayfinder.useWeblinkUrl_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => ' If WebLinks are used in the output, Wayfinder will output the link specified in the WebLink instead of the normal MODx link. To use the standard display of WebLinks (like any other Resource) set this to 0.',
              'area' => '',
              'area_trans' => '',
            ),
            'fullLink' => 
            array (
              'name' => 'fullLink',
              'desc' => 'prop_wayfinder.fullLink_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'If set to 1, will display the entire, absolute URL in the link. (It is recommended to use scheme instead.)',
              'area' => '',
              'area_trans' => '',
            ),
            'scheme' => 
            array (
              'name' => 'scheme',
              'desc' => 'prop_wayfinder.scheme_desc',
              'type' => 'list',
              'options' => 
              array (
                0 => 
                array (
                  'text' => 'prop_wayfinder.relative',
                  'value' => '',
                  'name' => 'Relative',
                ),
                1 => 
                array (
                  'text' => 'prop_wayfinder.absolute',
                  'value' => 'abs',
                  'name' => 'Absolute',
                ),
                2 => 
                array (
                  'text' => 'prop_wayfinder.full',
                  'value' => 'full',
                  'name' => 'Full',
                ),
              ),
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Determines how URLs are generated for each link. Set to "abs" to show the absolute URL, "full" to show the full URL, and blank to use the relative URL. Defaults to relative.',
              'area' => '',
              'area_trans' => '',
            ),
            'sortOrder' => 
            array (
              'name' => 'sortOrder',
              'desc' => 'prop_wayfinder.sortOrder_desc',
              'type' => 'list',
              'options' => 
              array (
                0 => 
                array (
                  'text' => 'prop_wayfinder.ascending',
                  'value' => 'ASC',
                  'name' => 'Ascending',
                ),
                1 => 
                array (
                  'text' => 'prop_wayfinder.descending',
                  'value' => 'DESC',
                  'name' => 'Descending',
                ),
              ),
              'value' => 'ASC',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Allows the menu to be sorted in either ascending or descending order.',
              'area' => '',
              'area_trans' => '',
            ),
            'sortBy' => 
            array (
              'name' => 'sortBy',
              'desc' => 'prop_wayfinder.sortBy_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'menuindex',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Sorts the output by any of the Resource fields on a level by level basis. This means that each submenu will be sorted independently of all other submenus at the same level. Random will sort the output differently every time the page is loaded if the snippet is called uncached.',
              'area' => '',
              'area_trans' => '',
            ),
            'limit' => 
            array (
              'name' => 'limit',
              'desc' => 'prop_wayfinder.limit_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '0',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Causes Wayfinder to only process the number of items specified per level.',
              'area' => '',
              'area_trans' => '',
            ),
            'cssTpl' => 
            array (
              'name' => 'cssTpl',
              'desc' => 'prop_wayfinder.cssTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'This parameter allows for a chunk containing a link to a style sheet or style information to be inserted into the head section of the generated page.',
              'area' => '',
              'area_trans' => '',
            ),
            'jsTpl' => 
            array (
              'name' => 'jsTpl',
              'desc' => 'prop_wayfinder.jsTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'This parameter allows for a chunk containing some Javascript to be inserted into the head section of the generated page.',
              'area' => '',
              'area_trans' => '',
            ),
            'rowIdPrefix' => 
            array (
              'name' => 'rowIdPrefix',
              'desc' => 'prop_wayfinder.rowIdPrefix_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'If set, Wayfinder will replace the id placeholder with a unique id consisting of the specified prefix plus the Resource id.',
              'area' => '',
              'area_trans' => '',
            ),
            'textOfLinks' => 
            array (
              'name' => 'textOfLinks',
              'desc' => 'prop_wayfinder.textOfLinks_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'menutitle',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'This field will be inserted into the linktext placeholder.',
              'area' => '',
              'area_trans' => '',
            ),
            'titleOfLinks' => 
            array (
              'name' => 'titleOfLinks',
              'desc' => 'prop_wayfinder.titleOfLinks_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'pagetitle',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'This field will be inserted into the linktitle placeholder.',
              'area' => '',
              'area_trans' => '',
            ),
            'displayStart' => 
            array (
              'name' => 'displayStart',
              'desc' => 'prop_wayfinder.displayStart_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Show the document as referenced by startId in the menu.',
              'area' => '',
              'area_trans' => '',
            ),
            'firstClass' => 
            array (
              'name' => 'firstClass',
              'desc' => 'prop_wayfinder.firstClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'first',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the first item at a given menu level.',
              'area' => '',
              'area_trans' => '',
            ),
            'lastClass' => 
            array (
              'name' => 'lastClass',
              'desc' => 'prop_wayfinder.lastClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'last',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the last item at a given menu level.',
              'area' => '',
              'area_trans' => '',
            ),
            'hereClass' => 
            array (
              'name' => 'hereClass',
              'desc' => 'prop_wayfinder.hereClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'active',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the items showing where you are, all the way up the chain.',
              'area' => '',
              'area_trans' => '',
            ),
            'parentClass' => 
            array (
              'name' => 'parentClass',
              'desc' => 'prop_wayfinder.parentClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for menu items that are a container and have children.',
              'area' => '',
              'area_trans' => '',
            ),
            'rowClass' => 
            array (
              'name' => 'rowClass',
              'desc' => 'prop_wayfinder.rowClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class denoting each output row.',
              'area' => '',
              'area_trans' => '',
            ),
            'outerClass' => 
            array (
              'name' => 'outerClass',
              'desc' => 'prop_wayfinder.outerClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the outer template.',
              'area' => '',
              'area_trans' => '',
            ),
            'innerClass' => 
            array (
              'name' => 'innerClass',
              'desc' => 'prop_wayfinder.innerClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the inner template.',
              'area' => '',
              'area_trans' => '',
            ),
            'levelClass' => 
            array (
              'name' => 'levelClass',
              'desc' => 'prop_wayfinder.levelClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class denoting every output row level. The level number will be added to the specified class (level1, level2, level3 etc if you specified "level").',
              'area' => '',
              'area_trans' => '',
            ),
            'selfClass' => 
            array (
              'name' => 'selfClass',
              'desc' => 'prop_wayfinder.selfClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for the current item.',
              'area' => '',
              'area_trans' => '',
            ),
            'webLinkClass' => 
            array (
              'name' => 'webLinkClass',
              'desc' => 'prop_wayfinder.webLinkClass_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'CSS class for weblink items.',
              'area' => '',
              'area_trans' => '',
            ),
            'outerTpl' => 
            array (
              'name' => 'outerTpl',
              'desc' => 'prop_wayfinder.outerTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the outer most container; if not included, a string including "<ul>[[+wf.wrapper]]</ul>" is assumed.',
              'area' => '',
              'area_trans' => '',
            ),
            'rowTpl' => 
            array (
              'name' => 'rowTpl',
              'desc' => 'prop_wayfinder.rowTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the regular row items.',
              'area' => '',
              'area_trans' => '',
            ),
            'parentRowTpl' => 
            array (
              'name' => 'parentRowTpl',
              'desc' => 'prop_wayfinder.parentRowTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for any Resource that is a container and has children. Remember the [wf.wrapper] placeholder to output the children documents.',
              'area' => '',
              'area_trans' => '',
            ),
            'parentRowHereTpl' => 
            array (
              'name' => 'parentRowHereTpl',
              'desc' => 'prop_wayfinder.parentRowHereTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the current Resource if it is a container and has children. Remember the [wf.wrapper] placeholder to output the children documents.',
              'area' => '',
              'area_trans' => '',
            ),
            'hereTpl' => 
            array (
              'name' => 'hereTpl',
              'desc' => 'prop_wayfinder.hereTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the current Resource.',
              'area' => '',
              'area_trans' => '',
            ),
            'innerTpl' => 
            array (
              'name' => 'innerTpl',
              'desc' => 'prop_wayfinder.innerTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for each submenu. If no innerTpl is specified the outerTpl is used in its place.',
              'area' => '',
              'area_trans' => '',
            ),
            'innerRowTpl' => 
            array (
              'name' => 'innerRowTpl',
              'desc' => 'prop_wayfinder.innerRowTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the row items in a subfolder.',
              'area' => '',
              'area_trans' => '',
            ),
            'innerHereTpl' => 
            array (
              'name' => 'innerHereTpl',
              'desc' => 'prop_wayfinder.innerHereTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the current Resource if it is in a subfolder.',
              'area' => '',
              'area_trans' => '',
            ),
            'activeParentRowTpl' => 
            array (
              'name' => 'activeParentRowTpl',
              'desc' => 'prop_wayfinder.activeParentRowTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for items that are containers, have children and are currently active in the tree.',
              'area' => '',
              'area_trans' => '',
            ),
            'categoryFoldersTpl' => 
            array (
              'name' => 'categoryFoldersTpl',
              'desc' => 'prop_wayfinder.categoryFoldersTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for category folders. Category folders are determined by setting the template to blank or by setting the link attributes field to rel="category".',
              'area' => '',
              'area_trans' => '',
            ),
            'startItemTpl' => 
            array (
              'name' => 'startItemTpl',
              'desc' => 'prop_wayfinder.startItemTpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Name of the chunk containing the template for the start item, if enabled via the &displayStart parameter. Note: the default template shows the start item but does not link it. If you do not need a link, a class can be applied to the default template using the parameter &firstClass=`className`.',
              'area' => '',
              'area_trans' => '',
            ),
            'permissions' => 
            array (
              'name' => 'permissions',
              'desc' => 'prop_wayfinder.permissions_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'list',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Will check for a permission on the Resource. Defaults to "list" - set to blank to skip normal permissions checks.',
              'area' => '',
              'area_trans' => '',
            ),
            'hereId' => 
            array (
              'name' => 'hereId',
              'desc' => 'prop_wayfinder.hereId_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Optional. If set, will change the "here" Resource to this ID. Defaults to the currently active Resource.',
              'area' => '',
              'area_trans' => '',
            ),
            'where' => 
            array (
              'name' => 'where',
              'desc' => 'prop_wayfinder.where_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Optional. A JSON object for where conditions for all items selected in the menu.',
              'area' => '',
              'area_trans' => '',
            ),
            'templates' => 
            array (
              'name' => 'templates',
              'desc' => 'prop_wayfinder.templates_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Optional. A comma-separated list of Template IDs to restrict selected Resources to.',
              'area' => '',
              'area_trans' => '',
            ),
            'previewUnpublished' => 
            array (
              'name' => 'previewUnpublished',
              'desc' => 'prop_wayfinder.previewunpublished_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'wayfinder:properties',
              'desc_trans' => 'Optional. If set to Yes, if you are logged into the mgr and have the view_unpublished permission, it will allow previewing of unpublished resources in your menus in the front-end.',
              'area' => '',
              'area_trans' => '',
            ),
          ),
          'moduleguid' => '',
          'static' => false,
          'static_file' => '',
          'content' => '/**
 * Wayfinder Snippet to build site navigation menus
 *
 * Totally refactored from original DropMenu nav builder to make it easier to
 * create custom navigation by using chunks as output templates. By using
 * templates, many of the paramaters are no longer needed for flexible output
 * including tables, unordered- or ordered-lists (ULs or OLs), definition lists
 * (DLs) or in any other format you desire.
 *
 * @version 2.1.1-beta5
 * @author Garry Nutting (collabpad.com)
 * @author Kyle Jaebker (muddydogpaws.com)
 * @author Ryan Thrash (modx.com)
 * @author Shaun McCormick (modx.com)
 * @author Jason Coward (modx.com)
 *
 * @example [[Wayfinder? &startId=`0`]]
 *
 * @var modX $modx
 * @var array $scriptProperties
 * 
 * @package wayfinder
 */
$wayfinder_base = $modx->getOption(\'wayfinder.core_path\',$scriptProperties,$modx->getOption(\'core_path\').\'components/wayfinder/\');

/* include a custom config file if specified */
if (isset($scriptProperties[\'config\'])) {
    $scriptProperties[\'config\'] = str_replace(\'../\',\'\',$scriptProperties[\'config\']);
    $scriptProperties[\'config\'] = $wayfinder_base.\'configs/\'.$scriptProperties[\'config\'].\'.config.php\';
} else {
    $scriptProperties[\'config\'] = $wayfinder_base.\'configs/default.config.php\';
}
if (file_exists($scriptProperties[\'config\'])) {
    include $scriptProperties[\'config\'];
}

/* include wayfinder class */
include_once $wayfinder_base.\'wayfinder.class.php\';
if (!$modx->loadClass(\'Wayfinder\',$wayfinder_base,true,true)) {
    return \'error: Wayfinder class not found\';
}
$wf = new Wayfinder($modx,$scriptProperties);

/* get user class definitions
 * TODO: eventually move these into config parameters */
$wf->_css = array(
    \'first\' => isset($firstClass) ? $firstClass : \'\',
    \'last\' => isset($lastClass) ? $lastClass : \'last\',
    \'here\' => isset($hereClass) ? $hereClass : \'active\',
    \'parent\' => isset($parentClass) ? $parentClass : \'\',
    \'row\' => isset($rowClass) ? $rowClass : \'\',
    \'outer\' => isset($outerClass) ? $outerClass : \'\',
    \'inner\' => isset($innerClass) ? $innerClass : \'\',
    \'level\' => isset($levelClass) ? $levelClass: \'\',
    \'self\' => isset($selfClass) ? $selfClass : \'\',
    \'weblink\' => isset($webLinkClass) ? $webLinkClass : \'\'
);

/* get user templates
 * TODO: eventually move these into config parameters */
$wf->_templates = array(
    \'outerTpl\' => isset($outerTpl) ? $outerTpl : \'\',
    \'rowTpl\' => isset($rowTpl) ? $rowTpl : \'\',
    \'parentRowTpl\' => isset($parentRowTpl) ? $parentRowTpl : \'\',
    \'parentRowHereTpl\' => isset($parentRowHereTpl) ? $parentRowHereTpl : \'\',
    \'hereTpl\' => isset($hereTpl) ? $hereTpl : \'\',
    \'innerTpl\' => isset($innerTpl) ? $innerTpl : \'\',
    \'innerRowTpl\' => isset($innerRowTpl) ? $innerRowTpl : \'\',
    \'innerHereTpl\' => isset($innerHereTpl) ? $innerHereTpl : \'\',
    \'activeParentRowTpl\' => isset($activeParentRowTpl) ? $activeParentRowTpl : \'\',
    \'categoryFoldersTpl\' => isset($categoryFoldersTpl) ? $categoryFoldersTpl : \'\',
    \'startItemTpl\' => isset($startItemTpl) ? $startItemTpl : \'\'
);

/* process Wayfinder */
$output = $wf->run();
if ($wf->_config[\'debug\']) {
    $output .= $wf->renderDebugOutput();
}

/* output results */
if ($wf->_config[\'ph\']) {
    $modx->setPlaceholder($wf->_config[\'ph\'],$output);
} else {
    return $output;
}',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
        ),
      ),
      'Quip' => 
      array (
        'fields' => 
        array (
          'id' => 27,
          'source' => 0,
          'property_preprocess' => false,
          'name' => 'Quip',
          'description' => 'A simple commenting component.',
          'editor_type' => 0,
          'category' => 15,
          'cache_type' => 0,
          'snippet' => '/**
 * Quip
 *
 * Copyright 2010-11 by Shaun McCormick <shaun@modx.com>
 *
 * This file is part of Quip, a simple commenting component for MODx Revolution.
 *
 * Quip is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * Quip is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * Quip; if not, write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330, Boston, MA 02111-1307 USA
 *
 * @package quip
 */
/**
 * Quip
 *
 * A simple comments component.
 *
 * @var modX $modx
 * @var array $scriptProperties
 *
 * @name Quip
 * @author Shaun McCormick <shaun@modx.com>
 * @package quip
 */
/** @var Quip $quip */
$quip = $modx->getService(\'quip\',\'Quip\',$modx->getOption(\'quip.core_path\',null,$modx->getOption(\'core_path\').\'components/quip/\').\'model/quip/\',$scriptProperties);
if (!($quip instanceof Quip)) return \'\';

$quip->initialize($modx->context->get(\'key\'));

$controller = $quip->loadController(\'Thread\');
$output = $controller->run($scriptProperties);
return $output;',
          'locked' => false,
          'properties' => 
          array (
            'thread' => 
            array (
              'name' => 'thread',
              'desc' => 'quip.prop_thread_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Уникальное имя темы.',
              'area_trans' => '',
            ),
            'parent' => 
            array (
              'name' => 'parent',
              'desc' => 'quip.prop_parent_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '0',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The parent to start at when displaying the thread.',
              'area_trans' => '',
            ),
            'threaded' => 
            array (
              'name' => 'threaded',
              'desc' => 'quip.prop_threaded_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Может или нет эта тема может иметь древовидные комментарии.',
              'area_trans' => '',
            ),
            'maxDepth' => 
            array (
              'name' => 'maxDepth',
              'desc' => 'quip.prop_maxdepth_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 5,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The maximum depth that replies can be made in a threaded comment thread.',
              'area_trans' => '',
            ),
            'replyResourceId' => 
            array (
              'name' => 'replyResourceId',
              'desc' => 'quip.prop_replyresourceid_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The ID of the Resource where the QuipReply snippet is held, for replying to threaded comments.',
              'area_trans' => '',
            ),
            'threadedPostMargin' => 
            array (
              'name' => 'threadedPostMargin',
              'desc' => 'quip.prop_threadedpostmargin_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 15,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Отступ в пикселях на который будут смещаться в право древовидные комментарии.',
              'area_trans' => '',
            ),
            'requireAuth' => 
            array (
              'name' => 'requireAuth',
              'desc' => 'quip.prop_requireauth_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, only logged-in users can post comments.',
              'area_trans' => '',
            ),
            'requireUsergroups' => 
            array (
              'name' => 'requireUsergroups',
              'desc' => 'quip.prop_requireusergroups_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Optional. A comma-separated list of User Groups to restrict commenting to.',
              'area_trans' => '',
            ),
            'closed' => 
            array (
              'name' => 'closed',
              'desc' => 'quip.prop_closed_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если установлено значение True, то добавление новых комментариев будет отключенно.',
              'area_trans' => '',
            ),
            'closeAfter' => 
            array (
              'name' => 'closeAfter',
              'desc' => 'quip.prop_closeafter_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 14,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Добавление комментариев к теме будет автоматически закрыто после указанного количества дней. Поставьте 0, чтобы оставить добавление комментариев открытым бесконечно.',
              'area_trans' => '',
            ),
            'dateFormat' => 
            array (
              'name' => 'dateFormat',
              'desc' => 'quip.prop_dateformat_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '%b %d, %Y at %I:%M %p',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Формат даты комментария.',
              'area_trans' => '',
            ),
            'useMargins' => 
            array (
              'name' => 'useMargins',
              'desc' => 'quip.prop_usemargins_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If false, Quip will use ol/li items for each comment and threaded comment. If false, will use padded margins for each comment in threading.',
              'area_trans' => '',
            ),
            'useCss' => 
            array (
              'name' => 'useCss',
              'desc' => 'quip.prop_usecss_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If true, Quip will provide a basic CSS template for the presentation.',
              'area_trans' => '',
            ),
            'rowCss' => 
            array (
              'name' => 'rowCss',
              'desc' => 'quip.prop_rowcss_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-comment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The CSS class to put on each comment\'s outer div container.',
              'area_trans' => '',
            ),
            'altRowCss' => 
            array (
              'name' => 'altRowCss',
              'desc' => 'quip.prop_altrowcss_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-comment-alt',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'CSS класс для каждого второго комментария.',
              'area_trans' => '',
            ),
            'olCss' => 
            array (
              'name' => 'olCss',
              'desc' => 'quip.prop_olcss_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-comment-parent',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'CSS класс to put in the parent ol tags for each comment.',
              'area_trans' => '',
            ),
            'unapprovedCss' => 
            array (
              'name' => 'unapprovedCss',
              'desc' => 'quip.prop_unapprovedcss_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-unapproved',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The CSS class to put on unapproved comments.',
              'area_trans' => '',
            ),
            'authorTpl' => 
            array (
              'name' => 'authorTpl',
              'desc' => 'quip.prop_authortpl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipAuthorTpl',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A name of a Chunk to use for the Author name in the comment.',
              'area_trans' => '',
            ),
            'nameField' => 
            array (
              'name' => 'nameField',
              'desc' => 'quip.prop_namefield_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'username',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The field to use for the author name of each comment. Recommended values are "name" or "username".',
              'area_trans' => '',
            ),
            'showAnonymousName' => 
            array (
              'name' => 'showAnonymousName',
              'desc' => 'quip.prop_showanonymousname_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If true, will display the value of anonymousName property (defaults to "Anonymous") if the user is not logged in when posting.',
              'area_trans' => '',
            ),
            'anonymousName' => 
            array (
              'name' => 'anonymousName',
              'desc' => 'quip.prop_anonymousname_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Имя для отображения в анонимных сообщениях. По умолчани "Anonymous".',
              'area_trans' => '',
            ),
            'allowRemove' => 
            array (
              'name' => 'allowRemove',
              'desc' => 'quip.prop_allowremove_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Разрешить авторизованным пользователям удалять собственные сообщения.',
              'area_trans' => '',
            ),
            'removeThreshold' => 
            array (
              'name' => 'removeThreshold',
              'desc' => 'quip.prop_removethreshold_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 3,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If allowRemove is true, the number of minutes a user can remove their posting after they have posted it. Defaults to 3 minutes.',
              'area_trans' => '',
            ),
            'allowReportAsSpam' => 
            array (
              'name' => 'allowReportAsSpam',
              'desc' => 'quip.prop_allowreportasspam_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Разрешить авторизованным пользователям помечать комментарии как спам.',
              'area_trans' => '',
            ),
            'useGravatar' => 
            array (
              'name' => 'useGravatar',
              'desc' => 'quip.prop_usegravatar_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если true, будет пытаться использовать изображения Gravatar  для аватаров.',
              'area_trans' => '',
            ),
            'gravatarIcon' => 
            array (
              'name' => 'gravatarIcon',
              'desc' => 'quip.prop_gravataricon_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'identicon',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The default Gravatar icon to load if none is found for a user.',
              'area_trans' => '',
            ),
            'gravatarSize' => 
            array (
              'name' => 'gravatarSize',
              'desc' => 'quip.prop_gravatarsize_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 50,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Размер в пикселях для Gravatar.',
              'area_trans' => '',
            ),
            'sortBy' => 
            array (
              'name' => 'sortBy',
              'desc' => 'quip.prop_sortby_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'rank',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Поле для сортировки.',
              'area_trans' => '',
            ),
            'sortByAlias' => 
            array (
              'name' => 'sortByAlias',
              'desc' => 'quip.prop_sortbyalias_desc',
              'type' => 'list',
              'options' => 
              array (
                0 => 
                array (
                  'text' => 'quip.comment',
                  'value' => 'quipComment',
                  'name' => 'Отзыв',
                ),
                1 => 
                array (
                  'text' => 'quip.author',
                  'value' => 'Author',
                  'name' => 'Автор',
                ),
              ),
              'value' => 'quipComment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The alias of classes to use with sort by.',
              'area_trans' => '',
            ),
            'sortDir' => 
            array (
              'name' => 'sortDir',
              'desc' => 'quip.prop_sortdir_desc',
              'type' => 'list',
              'options' => 
              array (
                0 => 
                array (
                  'text' => 'quip.ascending',
                  'value' => 'ASC',
                  'name' => 'По возрастанию',
                ),
                1 => 
                array (
                  'text' => 'quip.descending',
                  'value' => 'DESC',
                  'name' => 'По убыванию',
                ),
              ),
              'value' => 'ASC',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Направление сортировки.',
              'area_trans' => '',
            ),
            'toPlaceholder' => 
            array (
              'name' => 'toPlaceholder',
              'desc' => 'quip.prop_toplaceholder_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set, will output the content to the placeholder specified in this property, rather than outputting the content directly.',
              'area_trans' => '',
            ),
            'placeholderPrefix' => 
            array (
              'name' => 'placeholderPrefix',
              'desc' => 'quip.prop_placeholderprefix_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The prefix for the global placeholders set by Quip.',
              'area_trans' => '',
            ),
            'tplComment' => 
            array (
              'name' => 'tplComment',
              'desc' => 'quip.prop_tplcomment_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipComment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The comment itself. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplCommentOptions' => 
            array (
              'name' => 'tplCommentOptions',
              'desc' => 'quip.prop_tplcommentoptions_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipCommentOptions',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The options, such as delete, shown to an owner of a comment. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplComments' => 
            array (
              'name' => 'tplComments',
              'desc' => 'quip.prop_tplcomments_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipComments',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The outer wrapper for comments. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplReport' => 
            array (
              'name' => 'tplReport',
              'desc' => 'quip.prop_tplreport_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipReport',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The link on a comment to report as spam. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'reportAction' => 
            array (
              'name' => 'reportAction',
              'desc' => 'quip.prop_reportaction_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip_report',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The name of the submit field to initiate a comment report as spam.',
              'area_trans' => '',
            ),
            'removeAction' => 
            array (
              'name' => 'removeAction',
              'desc' => 'quip.prop_removeaction_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip_remove',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The name of the submit field to initiate a comment remove.',
              'area_trans' => '',
            ),
            'idPrefix' => 
            array (
              'name' => 'idPrefix',
              'desc' => 'quip.prop_idprefix_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'qcom',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если вы хотите использовать несколько вызовов Quip на одной странице, то задайте для каждого вызова свой префикс.',
              'area_trans' => '',
            ),
            'debug' => 
            array (
              'name' => 'debug',
              'desc' => 'quip.prop_debug_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Установите true, чтобы включить режим отладки. Не рекомендуется для рабочих сайтов.',
              'area_trans' => '',
            ),
            'debugUser' => 
            array (
              'name' => 'debugUser',
              'desc' => 'quip.prop_debuguser_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если включён режим отладки, то имя пользователя будет установленно для $modx->user .',
              'area_trans' => '',
            ),
            'debugUserId' => 
            array (
              'name' => 'debugUserId',
              'desc' => 'quip.prop_debuguserid_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если включён режим отладки, will set the id of $modx->user to this value.',
              'area_trans' => '',
            ),
            'limit' => 
            array (
              'name' => 'limit',
              'desc' => 'quip.prop_limit_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 0,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The number of comments to limit per page. Setting this to a non-zero number will enable pagination.',
              'area_trans' => '',
            ),
            'start' => 
            array (
              'name' => 'start',
              'desc' => 'quip.prop_start_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 0,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The default comment index to start on. Рекомендуется оставить 0.',
              'area_trans' => '',
            ),
            'tplPagination' => 
            array (
              'name' => 'tplPagination',
              'desc' => 'quip.prop_tplpagination_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipPagination',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A Chunk for the pagination OL wrapper.',
              'area_trans' => '',
            ),
            'tplPaginationItem' => 
            array (
              'name' => 'tplPaginationItem',
              'desc' => 'quip.prop_tplpaginationitem_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipPaginationItem',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A Chunk for each non-current pagination number link.',
              'area_trans' => '',
            ),
            'tplPaginationCurrentItem' => 
            array (
              'name' => 'tplPaginationCurrentItem',
              'desc' => 'quip.prop_tplpaginationcurrentitem_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipPaginationCurrentItem',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A Chunk for the current pagination number link.',
              'area_trans' => '',
            ),
            'paginationCls' => 
            array (
              'name' => 'paginationCls',
              'desc' => 'quip.prop_paginationcls_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-pagination',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'CSS класс для put on the pagination OL wrapper.',
              'area_trans' => '',
            ),
            'pageCls' => 
            array (
              'name' => 'pageCls',
              'desc' => 'quip.prop_pagecls_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-page-number',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'CSS класс для номеров страниц в разбивке на страницы.',
              'area_trans' => '',
            ),
            'currentPageCls' => 
            array (
              'name' => 'currentPageCls',
              'desc' => 'quip.prop_currentpagecls_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-page-current',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'CSS класс для номера текущей страницы в разбивке на страницы.',
              'area_trans' => '',
            ),
          ),
          'moduleguid' => '',
          'static' => false,
          'static_file' => '',
          'content' => '/**
 * Quip
 *
 * Copyright 2010-11 by Shaun McCormick <shaun@modx.com>
 *
 * This file is part of Quip, a simple commenting component for MODx Revolution.
 *
 * Quip is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * Quip is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * Quip; if not, write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330, Boston, MA 02111-1307 USA
 *
 * @package quip
 */
/**
 * Quip
 *
 * A simple comments component.
 *
 * @var modX $modx
 * @var array $scriptProperties
 *
 * @name Quip
 * @author Shaun McCormick <shaun@modx.com>
 * @package quip
 */
/** @var Quip $quip */
$quip = $modx->getService(\'quip\',\'Quip\',$modx->getOption(\'quip.core_path\',null,$modx->getOption(\'core_path\').\'components/quip/\').\'model/quip/\',$scriptProperties);
if (!($quip instanceof Quip)) return \'\';

$quip->initialize($modx->context->get(\'key\'));

$controller = $quip->loadController(\'Thread\');
$output = $controller->run($scriptProperties);
return $output;',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
        ),
      ),
      'QuipReply' => 
      array (
        'fields' => 
        array (
          'id' => 30,
          'source' => 0,
          'property_preprocess' => false,
          'name' => 'QuipReply',
          'description' => 'Displays a reply form for comments.',
          'editor_type' => 0,
          'category' => 15,
          'cache_type' => 0,
          'snippet' => '/**
 * Quip
 *
 * Copyright 2010-11 by Shaun McCormick <shaun@modx.com>
 *
 * This file is part of Quip, a simple commenting component for MODx Revolution.
 *
 * Quip is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * Quip is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * Quip; if not, write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330, Boston, MA 02111-1307 USA
 *
 * @package quip
 */
/**
 * Displays a reply form for a thread
 *
 * @var modX $modx
 * @var array $scriptProperties
 * @var Quip $quip
 *
 * @name QuipReply
 * @author Shaun McCormick <shaun@modx.com>
 * @package quip
 */
$quip = $modx->getService(\'quip\',\'Quip\',$modx->getOption(\'quip.core_path\',null,$modx->getOption(\'core_path\').\'components/quip/\').\'model/quip/\',$scriptProperties);
if (!($quip instanceof Quip)) return \'\';

$quip->initialize($modx->context->get(\'key\'));
$controller = $quip->loadController(\'ThreadReply\');
$output = $controller->run($scriptProperties);
return $output;

/* get thread */
$thread = $modx->getOption(\'quip_thread\',$_REQUEST,$modx->getOption(\'thread\',$scriptProperties,\'\'));
if (empty($thread)) return \'\';
$thread = $modx->getObject(\'quipThread\',array(\'name\' => $thread));
if (!$thread) return \'\';

/* sync properties with thread row values */
$thread->sync($scriptProperties);
$ps = $thread->get(\'quipreply_call_params\');
if (!empty($ps)) {
    $diff = array_diff_assoc($ps,$scriptProperties);
    if (empty($diff)) $diff = array_diff_assoc($scriptProperties,$ps);
}
if (empty($_REQUEST[\'quip_thread\']) && (!empty($diff) || empty($ps))) { /* only sync call params if not on threaded reply page */
    $thread->set(\'quipreply_call_params\',$scriptProperties);
    $thread->save();
}
/* if in threaded reply page, get the original passing values to QuipReply in the thread\'s main page and use those */
if (!empty($_REQUEST[\'quip_thread\']) && is_array($ps) && !empty($ps)) $scriptProperties = array_merge($scriptProperties,$ps);
unset($ps,$diff);

/* setup default properties */
$requireAuth = $modx->getOption(\'requireAuth\',$scriptProperties,false);
$requireUsergroups = $modx->getOption(\'requireUsergroups\',$scriptProperties,false);
$addCommentTpl = $modx->getOption(\'tplAddComment\',$scriptProperties,\'quipAddComment\');
$loginToCommentTpl = $modx->getOption(\'tplLoginToComment\',$scriptProperties,\'quipLoginToComment\');
$previewTpl = $modx->getOption(\'tplPreview\',$scriptProperties,\'quipPreviewComment\');
$closeAfter = $modx->getOption(\'closeAfter\',$scriptProperties,14);
$requirePreview = $modx->getOption(\'requirePreview\',$scriptProperties,false);
$previewAction = $modx->getOption(\'previewAction\',$scriptProperties,\'quip-preview\');
$postAction = $modx->getOption(\'postAction\',$scriptProperties,\'quip-post\');
$allowedTags = $modx->getOption(\'quip.allowed_tags\',$scriptProperties,\'<br><b><i>\');
$preHooks = $modx->getOption(\'preHooks\',$scriptProperties,\'\');
$postHooks = $modx->getOption(\'postHooks\',$scriptProperties,\'\');
$unsubscribeAction = $modx->getOption(\'unsubscribeAction\',$scriptProperties,\'quip_unsubscribe\');

/* get parent and auth */
$parent = $modx->getOption(\'quip_parent\',$_REQUEST,$modx->getOption(\'parent\',$scriptProperties,0));
$hasAuth = $modx->user->hasSessionContext($modx->context->get(\'key\')) || $modx->getOption(\'debug\',$scriptProperties,false) || empty($requireAuth);
if (!empty($requireUsergroups)) {
    $requireUsergroups = explode(\',\',$requireUsergroups);
    $hasAuth = $modx->user->isMember($requireUsergroups);
}

/* setup default placeholders */
$placeholders = array();
$p = $modx->request->getParameters();
unset($p[\'reported\'],$p[\'quip_approved\']);
$placeholders[\'parent\'] = $parent;
$placeholders[\'thread\'] = $thread->get(\'name\');
$placeholders[\'url\'] = $modx->makeUrl($modx->resource->get(\'id\'),\'\',$p);
$placeholders[\'idprefix\'] = $thread->get(\'idprefix\');

/* handle POST */
$fields = array();
$hasPreview = false;
if (!empty($_POST)) {
    foreach ($_POST as $k => $v) {
        $fields[$k] = str_replace(array(\'[\',\']\'),array(\'&#91;\',\'&#93;\'),$v);
    }
    
    $fields[\'name\'] = strip_tags($fields[\'name\']);
    $fields[\'email\'] = strip_tags($fields[\'email\']);
    $fields[\'website\'] = strip_tags($fields[\'website\']);
    
    /* verify a message was posted */
    if (empty($fields[\'comment\'])) $errors[\'comment\'] = $modx->lexicon(\'quip.message_err_ns\');
    if (empty($fields[\'name\'])) $errors[\'name\'] = $modx->lexicon(\'quip.name_err_ns\');
    if (empty($fields[\'email\'])) $errors[\'email\'] = $modx->lexicon(\'quip.email_err_ns\');
    
    if (!empty($_POST[$postAction]) && empty($errors)) {
        $comment = include_once $quip->config[\'processorsPath\'].\'web/comment/create.php\';
        if (is_object($comment) && $comment instanceof quipComment) {
            $params = $modx->request->getParameters();
            unset($params[$postAction],$params[\'quip_parent\'],$params[\'quip_thread\']);
            $params[\'quip_approved\'] = $comment->get(\'approved\') ? 1 : 0;
            $url = $comment->makeUrl(\'\',$params);

            /* if not approved, remove # and replace with success message #
             * since comment is not yet visible
             */
            if (!$comment->get(\'approved\')) {
                $url = str_replace(\'#\'.$thread->get(\'idprefix\').$comment->get(\'id\'),\'#quip-success-\'.$thread->get(\'idprefix\'),$url);
            }
            $modx->sendRedirect($url);
        } else if (is_array($comment)) {
            $errors = array_merge($errors,$comment);
        }
        $fields[$previewAction] = true;
    }
    /* handle preview */
    else if (!empty($fields[$previewAction]) && empty($errors)) {
        $errors = include_once $quip->config[\'processorsPath\'].\'web/comment/preview.php\';
    }
    if (!empty($errors)) {
        $placeholders[\'error\'] = implode("<br />\\n",$errors);
        foreach ($errors as $k => $v) {
            $placeholders[\'error.\'.$k] = $v;
        }
        $placeholders = array_merge($placeholders,$fields);
    }
}
/* display moderated success message */
if (isset($_GET[\'quip_approved\']) && $_GET[\'quip_approved\'] == 0) {
    $placeholders[\'successMsg\'] = $modx->lexicon(\'quip.comment_will_be_moderated\');
}

/* handle unsubscribing from thread */
if (!empty($_GET[$unsubscribeAction]) && $modx->user->hasSessionContext($modx->context->get(\'key\'))) {
    $profile = $modx->user->getOne(\'Profile\');
    if ($profile) {
        $notify = $modx->getObject(\'quipCommentNotify\',array(
            \'email\' => $profile->get(\'email\'),
            \'thread\' => $thread,
        ));
        if ($notify && $notify->remove()) {
            $placeholders[\'successMsg\'] = $modx->lexicon(\'quip.unsubscribed\');
        }
    }
}

/* if using recaptcha, load recaptcha html if user is not logged in */
$disableRecaptchaWhenLoggedIn = (boolean)$modx->getOption(\'disableRecaptchaWhenLoggedIn\',$scriptProperties,true);
$useRecaptcha = (boolean)$modx->getOption(\'recaptcha\',$scriptProperties,false);
if ($useRecaptcha && !($disableRecaptchaWhenLoggedIn && $hasAuth) && !$hasPreview) {
    $recaptcha = $modx->getService(\'recaptcha\',\'reCaptcha\',$quip->config[\'modelPath\'].\'recaptcha/\');
    if ($recaptcha instanceof reCaptcha) {
        $recaptchaTheme = $modx->getOption(\'recaptchaTheme\',$scriptProperties,\'clean\');
        $html = $recaptcha->getHtml($recaptchaTheme);
        $modx->setPlaceholder(\'quip.recaptcha_html\',$html);
    } else {
        return $modx->lexicon(\'quip.recaptcha_err_load\');
    }
}

/* build reply form */
$replyForm = \'\';

$stillOpen = $thread->checkIfStillOpen($closeAfter) && !$modx->getOption(\'closed\',$scriptProperties,false);
if ($hasAuth && $stillOpen) {
    $phs = array_merge($placeholders,array(
        \'username\' => $modx->user->get(\'username\'),
    ));
    $phs[\'unsubscribe\'] = \'\';

    /* prefill fields */
    $profile = $modx->user->getOne(\'Profile\');
    if ($profile) {
        $phs[\'name\'] = !empty($fields[\'name\']) ? $fields[\'name\'] : $profile->get(\'fullname\');
        $phs[\'email\'] = !empty($fields[\'email\']) ? $fields[\'email\'] : $profile->get(\'email\');
        $phs[\'website\'] = !empty($fields[\'website\']) ? $fields[\'website\'] : $profile->get(\'website\');

        /* allow for unsubscribing for logged-in users */
        if ($modx->user->hasSessionContext($modx->context->get(\'key\'))) {
            $notify = $modx->getObject(\'quipCommentNotify\',array(
                \'email\' => $profile->get(\'email\'),
                \'thread\' => $thread,
            ));
            if ($notify) {
                $phs[\'notifyId\'] = $notify->get(\'id\');
                $phs[\'unsubscribe\'] = $quip->getChunk(\'quipUnsubscribe\',$phs);
                $params = $modx->request->getParameters();
                $params[$unsubscribeAction] = 1;
                $phs[\'unsubscribeUrl\'] = $modx->makeUrl($modx->resource->get(\'id\'),\'\',$params);
            }
        }
    }

    /* if requirePreview == false, auto-can post */
    if (!$requirePreview) {
        $phs[\'can_post\'] = true;
    }
    $phs[\'post_action\'] = $postAction;
    $phs[\'preview_action\'] = $previewAction;
    $phs[\'allowed_tags\'] = $allowedTags;
    $phs[\'notifyChecked\'] = !empty($fields[\'notify\']) ? \' checked="checked"\' : \'\';

    $replyForm = $quip->getChunk($addCommentTpl,$phs);
} else if (!$stillOpen) {
    $replyForm = $modx->lexicon(\'quip.thread_autoclosed\');
} else {
    $replyForm = $quip->getChunk($loginToCommentTpl,$placeholders);
}

/* output or set to placeholder */
$toPlaceholder = $modx->getOption(\'toPlaceholder\',$scriptProperties,false);
if ($toPlaceholder) {
    $modx->setPlaceholder($toPlaceholder,$replyForm);
    return \'\';
}
return $replyForm;',
          'locked' => false,
          'properties' => 
          array (
            'requireAuth' => 
            array (
              'name' => 'requireAuth',
              'desc' => 'quip.prop_reply_requireauth_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если установить true, то только зарегистрированные пользователи смогут оставлять комментарии.',
              'area_trans' => '',
            ),
            'requireUsergroups' => 
            array (
              'name' => 'requireUsergroups',
              'desc' => 'quip.prop_reply_requireusergroups_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Optional. A comma-separated list of User Groups to restrict commenting to.',
              'area_trans' => '',
            ),
            'requirePreview' => 
            array (
              'name' => 'requirePreview',
              'desc' => 'quip.prop_reply_requirepreview_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, will require a user to preview their comment before posting.',
              'area_trans' => '',
            ),
            'closed' => 
            array (
              'name' => 'closed',
              'desc' => 'quip.prop_reply_closed_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, the thread will not accept new comments.',
              'area_trans' => '',
            ),
            'closeAfter' => 
            array (
              'name' => 'closeAfter',
              'desc' => 'quip.prop_reply_closeafter_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 14,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Will automatically close the thread to new comments after this number of days. Set to 0 to leave infinitely open.',
              'area_trans' => '',
            ),
            'moderate' => 
            array (
              'name' => 'moderate',
              'desc' => 'quip.prop_reply_moderate_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, all new posts to the thread will be moderated.',
              'area_trans' => '',
            ),
            'moderateAnonymousOnly' => 
            array (
              'name' => 'moderateAnonymousOnly',
              'desc' => 'quip.prop_reply_moderateanonymousonly_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, only anonymous (non-logged-in users) will be moderated.',
              'area_trans' => '',
            ),
            'moderateFirstPostOnly' => 
            array (
              'name' => 'moderateFirstPostOnly',
              'desc' => 'quip.prop_reply_moderatefirstpostonly_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If set to true, only the first post of the user will be moderated. All subsequent posts will be auto-approved. This only applies to logged-in users.',
              'area_trans' => '',
            ),
            'moderators' => 
            array (
              'name' => 'moderators',
              'desc' => 'quip.prop_reply_moderators_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A comma-separated list of moderator usernames for this thread.',
              'area_trans' => '',
            ),
            'moderatorGroup' => 
            array (
              'name' => 'moderatorGroup',
              'desc' => 'quip.prop_reply_moderatorgroup_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'Administrator',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Any Users in this User Group will have moderator access.',
              'area_trans' => '',
            ),
            'dontModerateManagerUsers' => 
            array (
              'name' => 'dontModerateManagerUsers',
              'desc' => 'quip.prop_reply_dontmoderatemanagerusers_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Never moderate users that are logged into the Revolution manager.',
              'area_trans' => '',
            ),
            'dateFormat' => 
            array (
              'name' => 'dateFormat',
              'desc' => 'quip.prop_reply_dateformat_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '%b %d, %Y at %I:%M %p',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The format of the dates displayed for a comment.',
              'area_trans' => '',
            ),
            'useCss' => 
            array (
              'name' => 'useCss',
              'desc' => 'quip.prop_reply_usecss_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если установить true, Quip will provide a basic CSS template for the presentation.',
              'area_trans' => '',
            ),
            'notifyEmails' => 
            array (
              'name' => 'notifyEmails',
              'desc' => 'quip.prop_reply_notifyemails_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'A comma-separated list of email addresses to send a notification email to when a new post is made on this thread.',
              'area_trans' => '',
            ),
            'recaptcha' => 
            array (
              'name' => 'recaptcha',
              'desc' => 'quip.prop_reply_recaptcha_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если установить true, будет включенна поддержка reCaptcha.',
              'area_trans' => '',
            ),
            'recaptchaTheme' => 
            array (
              'name' => 'recaptchaTheme',
              'desc' => 'quip.prop_reply_recaptchatheme_desc',
              'type' => 'list',
              'options' => 
              array (
                0 => 
                array (
                  'text' => 'quip.opt_red',
                  'value' => 'red',
                  'name' => 'Red',
                ),
                1 => 
                array (
                  'text' => 'quip.opt_white',
                  'value' => 'white',
                  'name' => 'White',
                ),
                2 => 
                array (
                  'text' => 'quip.opt_clean',
                  'value' => 'clean',
                  'name' => 'Clean',
                ),
                3 => 
                array (
                  'text' => 'quip.opt_blackglass',
                  'value' => 'blackglass',
                  'name' => 'Black Glass',
                ),
              ),
              'value' => 'clean',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If `recaptcha` is set to 1, this will select a theme for the reCaptcha widget.',
              'area_trans' => '',
            ),
            'disableRecaptchaWhenLoggedIn' => 
            array (
              'name' => 'disableRecaptchaWhenLoggedIn',
              'desc' => 'quip.prop_reply_disablerecaptchawhenloggedin_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If the user is logged in, do not use reCaptcha.',
              'area_trans' => '',
            ),
            'autoConvertLinks' => 
            array (
              'name' => 'autoConvertLinks',
              'desc' => 'quip.prop_reply_autoconvertlinks_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If true, will automatically convert URLs to links.',
              'area_trans' => '',
            ),
            'extraAutoLinksAttributes' => 
            array (
              'name' => 'extraAutoLinksAttributes',
              'desc' => 'quip.prop_reply_extraautolinksattributes_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Any extra HTML attributes to add to auto-converted links, if autoConvertLinks is set to 1.',
              'area_trans' => '',
            ),
            'useGravatar' => 
            array (
              'name' => 'useGravatar',
              'desc' => 'quip.prop_reply_usegravatar_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => true,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Если установить true, будет пытаться использовать изображения Gravatar  для аватаров.',
              'area_trans' => '',
            ),
            'gravatarIcon' => 
            array (
              'name' => 'gravatarIcon',
              'desc' => 'quip.prop_reply_gravataricon_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'identicon',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The default Gravatar icon to load if none is found for a user.',
              'area_trans' => '',
            ),
            'gravatarSize' => 
            array (
              'name' => 'gravatarSize',
              'desc' => 'quip.prop_reply_gravatarsize_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 50,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The size, in pixels, of the Gravatar.',
              'area_trans' => '',
            ),
            'tplAddComment' => 
            array (
              'name' => 'tplAddComment',
              'desc' => 'quip.prop_reply_tpladdcomment_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipAddComment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The add comment form. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplLoginToComment' => 
            array (
              'name' => 'tplLoginToComment',
              'desc' => 'quip.prop_reply_tpllogintocomment_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipLoginToComment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The portion to show when the user is not logged in. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplPreview' => 
            array (
              'name' => 'tplPreview',
              'desc' => 'quip.prop_reply_tplpreview_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipPreviewComment',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The tpl for the preview text. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'tplReport' => 
            array (
              'name' => 'tplReport',
              'desc' => 'quip.prop_reply_tplreport_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quipReport',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The link on a comment to report as spam. Can either be a chunk name or value. If set to a value, will override the chunk.',
              'area_trans' => '',
            ),
            'postAction' => 
            array (
              'name' => 'postAction',
              'desc' => 'quip.prop_reply_postaction_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-post',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The name of the submit field to initiate a comment post.',
              'area_trans' => '',
            ),
            'previewAction' => 
            array (
              'name' => 'previewAction',
              'desc' => 'quip.prop_reply_previewaction_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'quip-preview',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'The name of the submit field to initiate a comment preview.',
              'area_trans' => '',
            ),
            'idPrefix' => 
            array (
              'name' => 'idPrefix',
              'desc' => 'quip.prop_reply_idprefix_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => 'qcom',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If you want to use multiple Quip instances on a page, change this ID prefix.',
              'area_trans' => '',
            ),
            'redirectTo' => 
            array (
              'name' => 'redirectTo',
              'desc' => 'quip.prop_reply_redirectto_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Optional. After posting a reply, redirect to the Resource with this ID.',
              'area_trans' => '',
            ),
            'redirectToUrl' => 
            array (
              'name' => 'redirectToUrl',
              'desc' => 'quip.prop_reply_redirecttourl_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Optional. After posting a reply, redirect to this absolute URL.',
              'area_trans' => '',
            ),
            'debug' => 
            array (
              'name' => 'debug',
              'desc' => 'quip.prop_reply_debug_desc',
              'type' => 'combo-boolean',
              'options' => '',
              'value' => false,
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'Set to true to turn on debug mode. Not recommended for production sites.',
              'area_trans' => '',
            ),
            'debugUser' => 
            array (
              'name' => 'debugUser',
              'desc' => 'quip.prop_reply_debuguser_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If debug is on, will set the username of $modx->user to this value.',
              'area_trans' => '',
            ),
            'debugUserId' => 
            array (
              'name' => 'debugUserId',
              'desc' => 'quip.prop_reply_debuguserid_desc',
              'type' => 'textfield',
              'options' => '',
              'value' => '',
              'lexicon' => 'quip:properties',
              'area' => '',
              'desc_trans' => 'If debug is on, will set the id of $modx->user to this value.',
              'area_trans' => '',
            ),
          ),
          'moduleguid' => '',
          'static' => false,
          'static_file' => '',
          'content' => '/**
 * Quip
 *
 * Copyright 2010-11 by Shaun McCormick <shaun@modx.com>
 *
 * This file is part of Quip, a simple commenting component for MODx Revolution.
 *
 * Quip is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * Quip is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * Quip; if not, write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330, Boston, MA 02111-1307 USA
 *
 * @package quip
 */
/**
 * Displays a reply form for a thread
 *
 * @var modX $modx
 * @var array $scriptProperties
 * @var Quip $quip
 *
 * @name QuipReply
 * @author Shaun McCormick <shaun@modx.com>
 * @package quip
 */
$quip = $modx->getService(\'quip\',\'Quip\',$modx->getOption(\'quip.core_path\',null,$modx->getOption(\'core_path\').\'components/quip/\').\'model/quip/\',$scriptProperties);
if (!($quip instanceof Quip)) return \'\';

$quip->initialize($modx->context->get(\'key\'));
$controller = $quip->loadController(\'ThreadReply\');
$output = $controller->run($scriptProperties);
return $output;

/* get thread */
$thread = $modx->getOption(\'quip_thread\',$_REQUEST,$modx->getOption(\'thread\',$scriptProperties,\'\'));
if (empty($thread)) return \'\';
$thread = $modx->getObject(\'quipThread\',array(\'name\' => $thread));
if (!$thread) return \'\';

/* sync properties with thread row values */
$thread->sync($scriptProperties);
$ps = $thread->get(\'quipreply_call_params\');
if (!empty($ps)) {
    $diff = array_diff_assoc($ps,$scriptProperties);
    if (empty($diff)) $diff = array_diff_assoc($scriptProperties,$ps);
}
if (empty($_REQUEST[\'quip_thread\']) && (!empty($diff) || empty($ps))) { /* only sync call params if not on threaded reply page */
    $thread->set(\'quipreply_call_params\',$scriptProperties);
    $thread->save();
}
/* if in threaded reply page, get the original passing values to QuipReply in the thread\'s main page and use those */
if (!empty($_REQUEST[\'quip_thread\']) && is_array($ps) && !empty($ps)) $scriptProperties = array_merge($scriptProperties,$ps);
unset($ps,$diff);

/* setup default properties */
$requireAuth = $modx->getOption(\'requireAuth\',$scriptProperties,false);
$requireUsergroups = $modx->getOption(\'requireUsergroups\',$scriptProperties,false);
$addCommentTpl = $modx->getOption(\'tplAddComment\',$scriptProperties,\'quipAddComment\');
$loginToCommentTpl = $modx->getOption(\'tplLoginToComment\',$scriptProperties,\'quipLoginToComment\');
$previewTpl = $modx->getOption(\'tplPreview\',$scriptProperties,\'quipPreviewComment\');
$closeAfter = $modx->getOption(\'closeAfter\',$scriptProperties,14);
$requirePreview = $modx->getOption(\'requirePreview\',$scriptProperties,false);
$previewAction = $modx->getOption(\'previewAction\',$scriptProperties,\'quip-preview\');
$postAction = $modx->getOption(\'postAction\',$scriptProperties,\'quip-post\');
$allowedTags = $modx->getOption(\'quip.allowed_tags\',$scriptProperties,\'<br><b><i>\');
$preHooks = $modx->getOption(\'preHooks\',$scriptProperties,\'\');
$postHooks = $modx->getOption(\'postHooks\',$scriptProperties,\'\');
$unsubscribeAction = $modx->getOption(\'unsubscribeAction\',$scriptProperties,\'quip_unsubscribe\');

/* get parent and auth */
$parent = $modx->getOption(\'quip_parent\',$_REQUEST,$modx->getOption(\'parent\',$scriptProperties,0));
$hasAuth = $modx->user->hasSessionContext($modx->context->get(\'key\')) || $modx->getOption(\'debug\',$scriptProperties,false) || empty($requireAuth);
if (!empty($requireUsergroups)) {
    $requireUsergroups = explode(\',\',$requireUsergroups);
    $hasAuth = $modx->user->isMember($requireUsergroups);
}

/* setup default placeholders */
$placeholders = array();
$p = $modx->request->getParameters();
unset($p[\'reported\'],$p[\'quip_approved\']);
$placeholders[\'parent\'] = $parent;
$placeholders[\'thread\'] = $thread->get(\'name\');
$placeholders[\'url\'] = $modx->makeUrl($modx->resource->get(\'id\'),\'\',$p);
$placeholders[\'idprefix\'] = $thread->get(\'idprefix\');

/* handle POST */
$fields = array();
$hasPreview = false;
if (!empty($_POST)) {
    foreach ($_POST as $k => $v) {
        $fields[$k] = str_replace(array(\'[\',\']\'),array(\'&#91;\',\'&#93;\'),$v);
    }
    
    $fields[\'name\'] = strip_tags($fields[\'name\']);
    $fields[\'email\'] = strip_tags($fields[\'email\']);
    $fields[\'website\'] = strip_tags($fields[\'website\']);
    
    /* verify a message was posted */
    if (empty($fields[\'comment\'])) $errors[\'comment\'] = $modx->lexicon(\'quip.message_err_ns\');
    if (empty($fields[\'name\'])) $errors[\'name\'] = $modx->lexicon(\'quip.name_err_ns\');
    if (empty($fields[\'email\'])) $errors[\'email\'] = $modx->lexicon(\'quip.email_err_ns\');
    
    if (!empty($_POST[$postAction]) && empty($errors)) {
        $comment = include_once $quip->config[\'processorsPath\'].\'web/comment/create.php\';
        if (is_object($comment) && $comment instanceof quipComment) {
            $params = $modx->request->getParameters();
            unset($params[$postAction],$params[\'quip_parent\'],$params[\'quip_thread\']);
            $params[\'quip_approved\'] = $comment->get(\'approved\') ? 1 : 0;
            $url = $comment->makeUrl(\'\',$params);

            /* if not approved, remove # and replace with success message #
             * since comment is not yet visible
             */
            if (!$comment->get(\'approved\')) {
                $url = str_replace(\'#\'.$thread->get(\'idprefix\').$comment->get(\'id\'),\'#quip-success-\'.$thread->get(\'idprefix\'),$url);
            }
            $modx->sendRedirect($url);
        } else if (is_array($comment)) {
            $errors = array_merge($errors,$comment);
        }
        $fields[$previewAction] = true;
    }
    /* handle preview */
    else if (!empty($fields[$previewAction]) && empty($errors)) {
        $errors = include_once $quip->config[\'processorsPath\'].\'web/comment/preview.php\';
    }
    if (!empty($errors)) {
        $placeholders[\'error\'] = implode("<br />\\n",$errors);
        foreach ($errors as $k => $v) {
            $placeholders[\'error.\'.$k] = $v;
        }
        $placeholders = array_merge($placeholders,$fields);
    }
}
/* display moderated success message */
if (isset($_GET[\'quip_approved\']) && $_GET[\'quip_approved\'] == 0) {
    $placeholders[\'successMsg\'] = $modx->lexicon(\'quip.comment_will_be_moderated\');
}

/* handle unsubscribing from thread */
if (!empty($_GET[$unsubscribeAction]) && $modx->user->hasSessionContext($modx->context->get(\'key\'))) {
    $profile = $modx->user->getOne(\'Profile\');
    if ($profile) {
        $notify = $modx->getObject(\'quipCommentNotify\',array(
            \'email\' => $profile->get(\'email\'),
            \'thread\' => $thread,
        ));
        if ($notify && $notify->remove()) {
            $placeholders[\'successMsg\'] = $modx->lexicon(\'quip.unsubscribed\');
        }
    }
}

/* if using recaptcha, load recaptcha html if user is not logged in */
$disableRecaptchaWhenLoggedIn = (boolean)$modx->getOption(\'disableRecaptchaWhenLoggedIn\',$scriptProperties,true);
$useRecaptcha = (boolean)$modx->getOption(\'recaptcha\',$scriptProperties,false);
if ($useRecaptcha && !($disableRecaptchaWhenLoggedIn && $hasAuth) && !$hasPreview) {
    $recaptcha = $modx->getService(\'recaptcha\',\'reCaptcha\',$quip->config[\'modelPath\'].\'recaptcha/\');
    if ($recaptcha instanceof reCaptcha) {
        $recaptchaTheme = $modx->getOption(\'recaptchaTheme\',$scriptProperties,\'clean\');
        $html = $recaptcha->getHtml($recaptchaTheme);
        $modx->setPlaceholder(\'quip.recaptcha_html\',$html);
    } else {
        return $modx->lexicon(\'quip.recaptcha_err_load\');
    }
}

/* build reply form */
$replyForm = \'\';

$stillOpen = $thread->checkIfStillOpen($closeAfter) && !$modx->getOption(\'closed\',$scriptProperties,false);
if ($hasAuth && $stillOpen) {
    $phs = array_merge($placeholders,array(
        \'username\' => $modx->user->get(\'username\'),
    ));
    $phs[\'unsubscribe\'] = \'\';

    /* prefill fields */
    $profile = $modx->user->getOne(\'Profile\');
    if ($profile) {
        $phs[\'name\'] = !empty($fields[\'name\']) ? $fields[\'name\'] : $profile->get(\'fullname\');
        $phs[\'email\'] = !empty($fields[\'email\']) ? $fields[\'email\'] : $profile->get(\'email\');
        $phs[\'website\'] = !empty($fields[\'website\']) ? $fields[\'website\'] : $profile->get(\'website\');

        /* allow for unsubscribing for logged-in users */
        if ($modx->user->hasSessionContext($modx->context->get(\'key\'))) {
            $notify = $modx->getObject(\'quipCommentNotify\',array(
                \'email\' => $profile->get(\'email\'),
                \'thread\' => $thread,
            ));
            if ($notify) {
                $phs[\'notifyId\'] = $notify->get(\'id\');
                $phs[\'unsubscribe\'] = $quip->getChunk(\'quipUnsubscribe\',$phs);
                $params = $modx->request->getParameters();
                $params[$unsubscribeAction] = 1;
                $phs[\'unsubscribeUrl\'] = $modx->makeUrl($modx->resource->get(\'id\'),\'\',$params);
            }
        }
    }

    /* if requirePreview == false, auto-can post */
    if (!$requirePreview) {
        $phs[\'can_post\'] = true;
    }
    $phs[\'post_action\'] = $postAction;
    $phs[\'preview_action\'] = $previewAction;
    $phs[\'allowed_tags\'] = $allowedTags;
    $phs[\'notifyChecked\'] = !empty($fields[\'notify\']) ? \' checked="checked"\' : \'\';

    $replyForm = $quip->getChunk($addCommentTpl,$phs);
} else if (!$stillOpen) {
    $replyForm = $modx->lexicon(\'quip.thread_autoclosed\');
} else {
    $replyForm = $quip->getChunk($loginToCommentTpl,$placeholders);
}

/* output or set to placeholder */
$toPlaceholder = $modx->getOption(\'toPlaceholder\',$scriptProperties,false);
if ($toPlaceholder) {
    $modx->setPlaceholder($toPlaceholder,$replyForm);
    return \'\';
}
return $replyForm;',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
        ),
      ),
      'time' => 
      array (
        'fields' => 
        array (
          'id' => 6,
          'source' => 0,
          'property_preprocess' => false,
          'name' => 'time',
          'description' => '',
          'editor_type' => 0,
          'category' => 0,
          'cache_type' => 0,
          'snippet' => 'return time();',
          'locked' => false,
          'properties' => 
          array (
          ),
          'moduleguid' => '',
          'static' => false,
          'static_file' => '',
          'content' => 'return time();',
        ),
        'policies' => 
        array (
          'web' => 
          array (
          ),
        ),
        'source' => 
        array (
        ),
      ),
    ),
    'modTemplateVar' => 
    array (
    ),
  ),
);